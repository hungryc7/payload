@import '../../../scss/styles.scss';

//////////////////////
// HELPER MIXINS
//////////////////////

@mixin realtively-position-panels {
  .position-panel {
    position: relative;
    right: 0;
  }

  .action-panel {
    position: relative;
    left: 0;
  }
}

@mixin absolutely-position-panels {
  .position-panel {
    position: absolute;
    top: 0; right: 100%; bottom: 0;
  }

  .action-panel {
    position: absolute;
    top: 0; bottom: 0; left: 100%;
  }
}

//////////////////////
// COMPONENT STYLES
//////////////////////

.draggable-section {

  &__content-wrapper {
    display: flex;
    position: relative;
    padding-top: base(.75);
    margin-bottom: base(.5);
  }

  .draggable-section__content-wrapper {
    margin-bottom: 0;
  }

  &.is-closed {
    .draggable-section__content-wrapper {
      margin-bottom: base(1.75);
    }
  }

  &__section-header {
    display: flex;

    .toggle-collapse {
      margin: 0 0 0 auto;
      transform: rotate(.5turn);

      &--is-closed {
        transform: rotate(0turn);
      }
    }
  }

  &__render-fields-wrapper {
    width: 100%;
  }

  &.is-hovered > div {
    > .position-panel {
      .position-panel__controls-container {
        box-shadow: #{$style-stroke-width-m} 0px 0px 0px $color-dark-gray;
      }

      .position-panel__move-forward,
      .position-panel__move-backward {
        opacity: 1;
      }

      .position-panel__current-position {
        color: $color-dark-gray;
      }
    }

    > .action-panel {
      .action-panel__controls {
        opacity: 1;
        visibility: visible;
      }
    }

    .toggle-collapse {
      @include color-svg(white);

      .btn__icon {
        background-color: $color-gray;

        &:hover {
          background-color: $color-dark-gray;
        }
      }
    }
  }

  label.field-label {
    line-height: 1;
    padding-bottom: base(.75)
  }

  @include mid-break {
    @include realtively-position-panels();

    .position-panel__move-forward,
    .position-panel__move-backward {
      opacity: 1;
    }
  }
}

//////////////////////
// EXTERNAL SCOPES
//////////////////////

.collection-edit {
  @include absolutely-position-panels();

  @include mid-break {
    @include realtively-position-panels();
  }
}

.field-type.repeater .field-type.repeater {
  @include realtively-position-panels();
}

.field-type.repeater > div,
.field-type.flexible > div {
  > .draggable-section {
    &:last-child &:not(.is-closed) {
      .draggable-section__content-wrapper {
        margin-bottom: 0;
      }
    }
  }
}

.field-type.repeater {
  .draggable-section {
    &__content-wrapper {
      padding-top: 0;
    }
  }
}
